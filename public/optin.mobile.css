/* =========================================================
   TrueMatch — optin.html MOBILE-ONLY stylesheet
   File: optin.mobile.css
   Scope: only runs on optin.html (html.tm-home) and only <= 768px

   Updates in this version:
   - Reduce hero -> "How it works" gap
   - True carousels (NO PEEK) for:
       * How it works (steps)
       * Privacy & control (bento)
     with Prev/Next buttons (requires tiny mobile-only JS)
   - Slightly wider centered content on mobile (cards + container)
   ========================================================= */

@media (max-width: 768px) {

  /* --- Global scaling: shrink the whole page consistently --- */
  html.tm-home {
    /* Root scaling so rem-based sizes also shrink */
    font-size: 15px;

    /* Mobile rhythm */
    --tm-pad-x: 14px;
    --tm-gap: 14px;

    /* Type clamps (for elements using px/em directly) */
    --tm-h1: clamp(26px, 9.2vw, 38px);
    --tm-h2: clamp(20px, 7.2vw, 30px);
    --tm-body: clamp(14px, 4.1vw, 16px);
    --tm-small: clamp(12px, 3.5vw, 13px);

    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  html.tm-home body {
    overflow-x: hidden;
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    font-size: var(--tm-body);
    line-height: 1.55;
  }

  html.tm-home img,
  html.tm-home svg,
  html.tm-home video {
    max-width: 100%;
    height: auto;
  }

  /* Container: a bit wider + always centered */
  html.tm-home .container {
    width: 100%;
    margin-inline: auto;
    padding-inline: var(--tm-pad-x);
    max-width: 440px; /* keeps it centered on larger phones */
  }

  /* Tighten section spacing (overall shorter page) */
  html.tm-home main > section {
    padding-top: 48px !important;
    padding-bottom: 48px !important;
  }

  /* Anchor jumps (e.g., Opt-in Now) shouldn't hide titles behind the sticky header */
  html.tm-home section {
    scroll-margin-top: calc(82px + env(safe-area-inset-top));
  }

  /* --- Header / Mobile nav --- */
  html.tm-home .site-header {
    padding-top: env(safe-area-inset-top);
  }

  /* Ensure brand stays visible */
  html.tm-home .site-header .brand {
    display: flex !important;
    gap: 10px;
    align-items: center;
  }

  html.tm-home .brand__logo {
    width: 28px;
    height: 28px;
  }

  html.tm-home .brand__name {
    font-size: 15px;
  }

  html.tm-home .nav {
    gap: 12px;
    align-items: center;
  }

  /* Mobile: show toggle, hide desktop menu/actions */
  html.tm-home .nav__toggle { display: inline-flex; }
  html.tm-home .nav__menu,
  html.tm-home .nav__actions { display: none; }

  html.tm-home .nav__dropdown {
    display: none;
    position: absolute;
    left: var(--tm-pad-x);
    right: var(--tm-pad-x);
    top: calc(64px + env(safe-area-inset-top));
    z-index: 999;
    border-radius: 18px;
    padding: 14px;
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
  }

  html.tm-home .nav__toggle[aria-expanded="true"] + .nav__dropdown,
  html.tm-home .nav__dropdown.open,
  html.tm-home .nav__dropdown.is-open {
    display: grid;
    gap: 10px;
  }

  html.tm-home .nav__dropdown a {
    padding: 10px 12px;
    border-radius: 12px;
    text-decoration: none;
  }

  /* --- Hero (reduce extra space before How it works) --- */
  html.tm-home .hero {
    height: auto !important;
    min-height: unset !important;

    padding-top: calc(56px + env(safe-area-inset-top)) !important;
    padding-bottom: 18px !important; /* tighter gap to next section */
    margin-bottom: 0 !important;
  }

  /* Make the FIRST section after hero start sooner */
  html.tm-home #how-it-works {
    padding-top: 22px !important;
  }

  html.tm-home .hero__grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 18px;
    align-items: center;
  }

  html.tm-home .hero__copy { text-align: center; }

  html.tm-home .pill {
    font-size: var(--tm-small);
    margin-inline: auto;
    max-width: 32ch;
  }

  html.tm-home .hero h1 {
    font-size: var(--tm-h1);
    line-height: 1.05;
    letter-spacing: -0.02em;
    margin: 10px 0 10px;
  }

  html.tm-home .hero p {
    font-size: var(--tm-body);
    margin-inline: auto;
    max-width: 38ch;
  }

  html.tm-home .hero__cta {
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
    margin-top: 16px;
  }

  html.tm-home .hero__cta .btn,
  html.tm-home .hero__cta button.btn {
    width: 100%;
    min-height: 46px;
    border-radius: 999px;
    justify-content: center;
  }

  html.tm-home .hero__social-proof {
    justify-content: center;
    flex-wrap: wrap;
  }

  html.tm-home .hero__img-wrapper {
    width: min(360px, 94vw); /* slightly wider */
    margin-inline: auto;
  }

  html.tm-home .hero__logo {
    width: min(270px, 74vw);
    height: auto;
    display: block;
    margin-inline: auto;
  }

  /* Scroll hint is noisy on mobile */
  html.tm-home .scroll-indicator { display: none; }

  /* --- Titles --- */
  html.tm-home .section__title {
    font-size: var(--tm-h2);
    line-height: 1.15;
    margin: 0 0 14px;
    text-align: center;
  }

  /* =========================================================
     NO-PEEK base (works even without the tm-carousel wrapper)
     - You still need the wrapper + JS only if you want buttons.
     ========================================================= */

  html.tm-home .steps-wrapper,
  html.tm-home .bento-grid {
    display: flex !important;
    gap: 0 !important;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-snap-type: x mandatory;
    scroll-snap-stop: always;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    padding-inline: 12px;
    scroll-padding-inline: 12px;
    touch-action: pan-x;
  }

  html.tm-home .steps-wrapper::-webkit-scrollbar,
  html.tm-home .bento-grid::-webkit-scrollbar {
    height: 0;
  }

  html.tm-home .steps-wrapper .step-card,
  html.tm-home .bento-grid .bento-card {
    flex: 0 0 100%;
    min-width: 100%;
    scroll-snap-align: start;
  }

  html.tm-home .bento-grid .bento-card.wide {
    flex-basis: 100%;
    min-width: 100%;
  }

  /* =========================================================
     TRUE CAROUSEL (NO PEEK) + BUTTONS
     Requires adding wrapper markup + tiny JS.
     ========================================================= */

  /* Wrapper */
  html.tm-home .tm-carousel {
    position: relative;
    margin-top: 14px;
  }

  /* Track (the scroll container) */
  html.tm-home .tm-carousel .steps-wrapper,
  html.tm-home .tm-carousel .bento-grid {
    display: flex !important;
    gap: 0 !important;                /* no peek from gaps */
    overflow-x: auto;
    overflow-y: hidden;
    scroll-snap-type: x mandatory;
    scroll-snap-stop: always;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    padding-inline: 12px;             /* inner gutter */
    scroll-padding-inline: 12px;
    touch-action: pan-x;
  }

  html.tm-home .tm-carousel .steps-wrapper::-webkit-scrollbar,
  html.tm-home .tm-carousel .bento-grid::-webkit-scrollbar {
    height: 0;
  }

  /* Each slide takes full width so neighbors are NOT visible */
  html.tm-home .tm-carousel .step-card,
  html.tm-home .tm-carousel .bento-card {
    flex: 0 0 100%;
    min-width: 100%;
    scroll-snap-align: start;
  }

  /* Remove wide behavior inside carousel (still full width slide) */
  html.tm-home .tm-carousel .bento-card.wide {
    flex-basis: 100%;
    min-width: 100%;
  }

  /* Slightly tighten card padding for mobile feel */
  html.tm-home .tm-carousel .step-card { padding: 18px 16px; }
  html.tm-home .tm-carousel .bento-card { padding: 18px 16px; }

  html.tm-home .step-number {
    font-size: 40px;
    opacity: .18;
  }

  /* Prev/Next buttons */
  html.tm-home .tm-carousel__btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 42px;
    height: 42px;
    border-radius: 999px;
    border: 1px solid rgba(100, 233, 238, .24);
    background: rgba(0, 0, 0, .55);
    color: rgba(100, 233, 238, .95);
    display: grid;
    place-items: center;
    z-index: 5;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  html.tm-home .tm-carousel__btn:active {
    transform: translateY(-50%) scale(.98);
  }

  html.tm-home .tm-carousel__btn[disabled] {
    opacity: .28;
    pointer-events: none;
  }

  html.tm-home .tm-carousel__btn.prev { left: 6px; }
  html.tm-home .tm-carousel__btn.next { right: 6px; }

  /* Arrow icon (CSS) */
  html.tm-home .tm-carousel__btn::before {
    content: "";
    width: 10px;
    height: 10px;
    border-right: 2px solid currentColor;
    border-bottom: 2px solid currentColor;
    display: block;
  }
  html.tm-home .tm-carousel__btn.prev::before { transform: rotate(135deg); }
  html.tm-home .tm-carousel__btn.next::before { transform: rotate(-45deg); }

  /* Keep buttons from blocking swipe at the very edges */
  html.tm-home .tm-carousel .steps-wrapper,
  html.tm-home .tm-carousel .bento-grid {
    padding-left: 54px;   /* space so left button doesn't cover content */
    padding-right: 54px;  /* space so right button doesn't cover content */
    scroll-padding-left: 54px;
    scroll-padding-right: 54px;
  }

  /* =========================================================
     FAQ: keep vertical (cleaner on mobile)
     ========================================================= */
  html.tm-home .faq-wrapper {
    display: grid !important;
    gap: 12px !important;
  }

  html.tm-home .faq-card summary {
    padding: 16px 16px !important;
  }

  /* --- Opt-in form: wider + centered --- */
  html.tm-home .price-card.concierge {
    width: min(440px, 94vw);
    max-width: none !important;
    margin-inline: auto;
    padding: 18px 16px !important;
  }

  html.tm-home .optin-form { gap: 12px !important; }

  html.tm-home .optin-form input,
  html.tm-home .optin-form select,
  html.tm-home .optin-form textarea {
    font-size: 16px; /* prevents iOS zoom */
    min-height: 46px;
    padding: 12px 14px;
    border-radius: 14px;
  }

  html.tm-home .optin-form textarea { min-height: 110px; }

  /* --- Footer: compact + centered --- */
  html.tm-home .site-footer { padding-top: 54px !important; }

  html.tm-home .footer-middle-content {
    display: grid;
    grid-template-columns: 1fr;
    gap: 18px;
  }

  html.tm-home .footer-newsletter-card {
    width: min(440px, 94vw);
    margin-inline: auto;
    padding: 18px 16px !important;
  }

  html.tm-home .footer-newsletter-card .footer-form {
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
  }

  html.tm-home .footer-newsletter-card .btn {
    width: 100%;
    min-height: 44px;
    justify-content: center;
  }
}

/* Ultra-small devices (320–360px): shrink a bit more */
@media (max-width: 360px) {
  html.tm-home { font-size: 14px; }
  html.tm-home .brand__name { display: none; } /* saves header space */
  html.tm-home .hero__img-wrapper { width: min(340px, 94vw); }
}

/* Reduce motion support */
@media (prefers-reduced-motion: reduce) {
  html.tm-home * {
    animation: none !important;
    transition: none !important;
    scroll-behavior: auto !important;
  }
}
